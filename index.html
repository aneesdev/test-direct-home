<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Direct Home Components Test</title>

  <script type="module">
    (async () => {
      try {
        await import(
          "https://home.devdksa.com/direct-web-components.es.js"
        );
        //load components
        loadWebComponents("wc-direct-header");
        loadWebComponents("wc-direct-footer");
      } catch (error) {
        document.querySelector(".main-app")?.removeAttribute("hidden");
        console.error("Failed to load module:", error);
      }
    })();
  </script>

  <style>
    wc-direct-header,
    wc-direct-footer {
      z-index: auto;
    }
  </style>

  <link href="./output.css" rel="stylesheet">

  <style>
    html,
    body {
      font-family: 'DirectFont', 'Inter';
    }

    /* Hide scrollbars specifically in Firefox */
    iframe::-webkit-scrollbar {
      display: none;
      /* Chrome, Edge, and Safari */
    }

    iframe {
      scrollbar-width: none;
      /* Firefox */
    }

    :focus-visible {
      outline: none;
    }

    /* Base Header and Iframe Styling */
    .main-header {
      visibility: hidden;
      /* Prevent flickering during load */
      height: 500px;
      /* Default height for desktop */
      opacity: 0;
      /* Hidden by default */
      transition: opacity 0.3s ease-in;
      /* Smooth fade-in */
    }

    .flight-search-bar {
      width: 100%;
      /* Ensure it spans the full width */
      height: 430px;
      /* Default height for desktop */
      min-height: 430px;
      opacity: 0;
      /* Hidden initially */
      transition: opacity 0.3s ease-in;
    }
  </style>
</head>

<body>
  <wc-direct-header hidden></wc-direct-header>

  <main id="app" class="main-app" hidden>
    <div>
      <!-- Header Section -->
      <header class="relative w-full text-white bg-orange-700 main-header">
        <div class="pt-10 pb-5 pl-10 pr-10 mb-1 ">
          <div class="absolute inset-0 bg-center bg-cover opacity-50"
            style="background-image: url('https://www.nerdwallet.com/tachyon/2021/04/THY-7378W_PR_img01_PR-0413.jpg?resize=1920%2C1152');">
          </div>
          <div class="relative z-10">
            <div class="flex items-center justify-between mb-4">
              <h1 class="font-bold text-1xl lg:text-3xl">أحجز الخطوط التركية بأقل سعر عبر دايركت</h1>
              <img src="https://1000logos.net/wp-content/uploads/2020/04/Turkish_Airlines_logo.png"
                alt="Turkish Airlines Logo" class="h-12 mx-4 bg-white rounded pa-1">
            </div>
            <p class="text-lg">تعد الخطوط الجوية التركية واحدة من أكبر شركات الطيران انتشارا على مستوى العالم.. أحجز
              الان
              عبر دايركت الخطوط التركية بسهولة للحصول على أفضل سعر
            </p>

            <!-- <p class="text-lg">
              لوريم إيبسوم(Lorem Ipsum) هو ببساطة نص شكلي (بمعنى أن الغاية هي الشكل وليس المحتوى) ويُستخدم في صناعات
              المطابع ودور النشر. كان لوريم إيبسوم ولايزال المعيار للنص الشكلي منذ القرن الخامس عشر عندما قامت مطبعة
              مجهولة برص مجموعة من الأحرف بشكل عشوائي أخذتها من نص، لتكوّن كتيّب بمثابة دليل أو مرجع شكلي لهذه الأحرف.
              خمسة قرون من الزمن لم تقضي على هذا النص، بل انه حتى صار مستخدماً وبشكله الأصلي في الطباعة والتنضيد
              الإلكتروني. انتشر بشكل كبير في ستينيّات هذا القرن مع إصدار رقائق "ليتراسيت" (Letraset) البلاستيكية تحوي
              مقاطع من هذا النص، وعاد لينتشر مرة أخرى مؤخراَ مع ظهور برامج النشر الإلكتروني مثل "ألدوس بايج مايكر"
              (Aldus PageMaker) والتي حوت أيضاً على نسخ من نص لوريم إيبسوم.
            </p> -->
          </div>
        </div>


        <iframe class="relative flight-search-bar" width="100%" frameborder="0" allowfullscreen scrolling="no"></iframe>

      </header>


      <!-- Main Content -->
      <div class="p-6 mx-auto max-w-7xl main-content">
        <div class="mt-6 lg:flex">
          <div>
            <!-- About Section -->
            <section class="flex-1 p-6 bg-white rounded-lg shadow">
              <h2 class="mb-4 text-2xl font-semibold text-gray-800">نبذة عن الخطوط الجوية التركية</h2>
              <p class="leading-loose text-gray-700">
                الخطوط التركية هي شركة طيران وطنية تتخذ مطار أتاتورك الدولي مركزاً رئيسياً لانطلاق رحلاتها ويقع مقرها
                الرئيسي في مدينة إسطنبول وهي واحدة من شركات الطيران الكبرى في أوروبا والعالم حيث تسيير رحلاتها إلى أكثر
                من
                300 وجهه داخل وخارج تركيا كما تمتلك أسطول من الطائرات الحديثة المجهزة لرفاهية وأمان المسافرين وفق أعلى
                معايير السلامة الدولية وتحرص دائماً على تقديم أفضل خدمة لعملائها
                تمتع بتجربة سفر ممتعة وفريدة من نوعها مع دايركت عبر الخطوط الجوية التركية

              </p>
            </section>

            <!-- Features Section -->
            <section class="p-6 mt-6 bg-white rounded-lg shadow">
              <h2 class="mb-4 text-2xl font-semibold text-gray-800">مميزات الخطوط الجوية التركية</h2>
              <ul class="leading-loose text-gray-700 list-disc list-inside">
                <li>صنفت ضمن أفضل 10 شركات طيران في العالم</li>
                <li>حصلت على جائزة أفضل شركة طيران في أوروبا لست سنوات متتالية</li>
                <li>تمتلك أسطول ضخم من الطائرات الحديثة به كافة وسائل الأمان والرفاهية</li>
                <li>تقديم أفضل الخدمات على متن طائراتها مع توفير المأكولات والمشروبات المجانية</li>
              </ul>
            </section>

            <!-- Destinations Section -->
            <section class="p-6 mt-6 bg-white rounded-lg shadow">
              <h2 class="mb-4 text-2xl font-semibold text-gray-800">وجهات الخطوط الجوية التركية</h2>
              <p class="leading-loose text-gray-700">
                يمكنك السفر عبر الطيران التركي لأكثر من 300 وجهة موزعة على 120 دولة حول العالم ومن أكثر الوجهات طلباً
                عليها:
              </p>
              <p class="leading-loose text-gray-700">حجز رحلات الخطوط الجوية التركية من وإلى
                الرياض/جدة/القاهرة/باريس/مالطا/طرابلس/ميونخ/لندن/برشلونة/مدريد/روما/ميلانو</p>
            </section>

            <!-- Baggage Policy Section -->
            <section class="p-6 mt-6 bg-white rounded-lg shadow">
              <h2 class="mb-4 text-2xl font-semibold text-gray-800">سياسة الأمتعة داخل الطيران التركي</h2>
              <p class="leading-loose text-gray-700">
                من المهم أن تكون على علم بحد الأمتعة المسموح به على متن الخطوط التركية وتختلف سياسة الأمتعة حسب نوع درجة
                الحجز
                والوجهة:
              </p>
              <h3 class="mt-4 text-xl font-bold text-gray-800">سياسة الأمتعة للدرجة السياحية</h3>
              <ul class="leading-loose text-gray-700 list-disc list-inside">
                <li>يحق لكل مسافر حمل أمتعة لا يتجاوز وزنها 20 كجم</li>
                <li>يسمح لكل مسافر بحمل حقيبة يدوية لا يتجاوز وزنها 8 كجم</li>
              </ul>
              <h3 class="mt-4 text-xl font-bold text-gray-800">سياسة الأمتعة لدرجة رجال الأعمال</h3>
              <ul class="leading-loose text-gray-700 list-disc list-inside">
                <li>يحق لكل مسافر حمل أمتعة لا يتجاوز وزنها 30 كجم</li>
                <li>يسمح لكل مسافر بحمل حقيبتي يد لا يتجاوز وزن الواحدة 8 كجم</li>
              </ul>
            </section>

            <!-- Benefits Section -->
            <section class="p-6 mt-6 bg-white rounded-lg shadow">
              <h2 class="mb-4 text-2xl font-semibold text-gray-800">مميزات حجز رحلات الخطوط التركية عبر دايركت</h2>
              <ul class="leading-loose text-gray-700 list-disc list-inside">
                <li>نمتلك مستشارين خبراء في مجال الطيران</li>
                <li>نقدم لك خدمات احترافية مع خصومات مذهلة</li>
                <li>حجز رحلات الخطوط الجوية بسهولة وفي أسرع وقت</li>
                <li>متواجدين دائماً بجانبك لمساعدتك وتتبع حجزك</li>
                <li>خدمة العملاء في انتظار اتصالك على مدار الساعة</li>
              </ul>
            </section>

            <section class="p-5 mt-6 bg-white rounded-lg shadow">
              <h2 class="mb-4 text-2xl font-semibold text-gray-800">عن طيران التركية</h2>

              <div class="w-full">
                <table class="w-full text-sm text-right text-gray-500 border-collapse rtl:text-right">
                  <colgroup>
                    <col width="298">
                    <col width="298">
                  </colgroup>
                  <tbody>
                    <tr class="bg-white border">
                      <th scope="row"
                        class="px-4 py-2 text-xs font-medium text-gray-900 whitespace-normal border sm:text-sm">
                        الرمز الخاص بإتحاد النقل الجوي الدولي (IATA)
                      </th>
                      <td class="px-4 py-2 text-xs sm:text-sm">EK</td>
                    </tr>
                    <tr class="bg-white border">
                      <th scope="row"
                        class="px-4 py-2 text-xs font-medium text-gray-900 whitespace-normal border sm:text-sm">
                        الرمز الخاص بمنظمة الطيران المدني الدولي (ICAO)
                      </th>
                      <td class="px-4 py-2 text-xs sm:text-sm">UAE</td>
                    </tr>
                    <tr class="bg-white border">
                      <th scope="row"
                        class="px-4 py-2 text-xs font-medium text-gray-900 whitespace-normal border sm:text-sm">
                        مقر طيران الإمارات
                      </th>
                      <td class="px-4 py-2 text-xs sm:text-sm">دبي - الإمارات العربية المتحدة</td>
                    </tr>
                    <tr class="bg-white border">
                      <th scope="row"
                        class="px-4 py-2 text-xs font-medium text-gray-900 whitespace-normal border sm:text-sm">
                        المطار الرئيسي للشركة
                      </th>
                      <td class="px-4 py-2 text-xs sm:text-sm">مطار دبي الدولي</td>
                    </tr>
                    <tr class="bg-white border">
                      <th scope="row"
                        class="px-4 py-2 text-xs font-medium text-gray-900 whitespace-normal border sm:text-sm">
                        حجم الأسطول التي تغطيها الإماراتية
                      </th>
                      <td class="px-4 py-2 text-xs sm:text-sm">حوالي 157 وجهة (محلية ودولية)</td>
                    </tr>
                    <tr class="bg-white border">
                      <th scope="row"
                        class="px-4 py-2 text-xs font-medium text-gray-900 whitespace-normal border sm:text-sm">
                        أشهر الوجهات
                      </th>
                      <td class="px-4 py-2 text-xs sm:text-sm">DXB, DAC, MNL EBB</td>
                    </tr>
                  </tbody>
                </table>
              </div>

            </section>

            <!-- Contact Section -->
            <section class="p-6 mt-6 bg-white rounded-lg shadow">
              <h2 class="mb-4 text-2xl font-semibold text-gray-800">تواصل معنا</h2>
              <p class="leading-loose text-gray-700">الرياض / جدة / بريدة / الخبر</p>
              <p class="leading-loose text-gray-700">راسلنا واتساب</p>
            </section>
          </div>

          <div>
            <!-- Quick Info Section -->
            <aside class="w-full p-6 rounded-lg shadow lg:w-80">
              <div class="mb-6 text-center">
                <img src="https://1000logos.net/wp-content/uploads/2020/04/Turkish_Airlines_logo.png"
                  alt="Turkish Airlines Logo" class="h-16">
              </div>
              <div class="leading-loose text-gray-700">
                <p class="mb-2">
                  <strong>رقم خدمة العملاء (داخل السعودية):</strong><br>
                  +90 212 463 63 63
                </p>
                <p class="mb-2">
                  <strong>كود أياتا:</strong><br>
                  TK
                </p>
                <p class="mb-4">
                  <strong>موقع إلكتروني:</strong><br>
                  <a href="https://www.turkishairlines.com" target="_blank" class="text-blue-600 underline">
                    www.turkishairlines.com
                  </a>
                </p>
              </div>
            </aside>
          </div>
        </div>
      </div>
    </div>
  </main>

  <wc-direct-footer hidden></wc-direct-footer>
</body>

<script>
  async function loadWebComponents(tag) {
    try {
      const component = await getComponent(tag);
      if (tag === 'wc-direct-header') {
        loadEventListeners();
      }
      updateShadowDom(component, "https://home.devdksa.com/style.css");
    } catch (error) {
      console.error("Error:", error);
    }
  }

  function getComponent(tag) {
    return new Promise((resolve, reject) => {
      const timeout = 5000; // 5 seconds timeout
      const interval = 100; // Check every 100ms
      let elapsedTime = 0;
      const moduleLoaded = setInterval(() => {
        const component = document.querySelector(tag);
        if (component && component.shadowRoot) {
          clearInterval(moduleLoaded);
          resolve(component);
        } else if ((elapsedTime += interval) >= timeout) {
          clearInterval(moduleLoaded);
          reject(`${tag} not found.`);
        }
      }, interval);
    });
  }

  function loadEventListeners() {
    window.addEventListener("wc-state-locale", (event) => {
      // do something
    });

    window.addEventListener("wc-state-currency", (event) => {
      // do something
    });
  }

  function updateShadowDom(component, url) {
    // update component styles
    const styleLink = document.createElement("link");
    styleLink.setAttribute("rel", "stylesheet");
    styleLink.setAttribute("href", url);
    component.shadowRoot.appendChild(styleLink);
    // update component attributes
    styleLink.onload = () => {
      component.removeAttribute("hidden");
      document.querySelector(".main-app")?.removeAttribute("hidden");
    };
  }

  function adjustHeaderAndSearchBar() {
    const mainHeader = document.querySelector('.main-header');
    const flightSearchBar = document.querySelector('.flight-search-bar');

    if (!mainHeader || !flightSearchBar) {
      console.error("Main header or flight search bar not found.");
      return;
    }

    const viewportWidth = window.innerWidth;

    // Force layout recalculation
    document.body.offsetHeight;

    // Calculate heights dynamically
    let totalContentHeight = 0;
    Array.from(mainHeader.children).forEach((child) => {
      if (child !== flightSearchBar) {
        const childStyle = window.getComputedStyle(child);
        const height = child.getBoundingClientRect().height; // More reliable than offsetHeight
        const marginTop = parseFloat(childStyle.marginTop) || 0;
        const marginBottom = parseFloat(childStyle.marginBottom) || 0;
        totalContentHeight += height + marginTop + marginBottom;
      }
    });

    let iframeHeight = flightSearchBar.getBoundingClientRect().height || 0;
    let mainHeaderHeight = totalContentHeight + 155;

    if (viewportWidth <= 768) {
      mainHeaderHeight = totalContentHeight + 387.6;
    }

    console.log("Computed Heights:", {
      totalContentHeight,
      iframeHeight,
      mainHeaderHeight,
      viewportWidth,
    });

    // Apply height to the main header
    mainHeader.style.height = `${mainHeaderHeight}px`;

    // Fade in the header
    mainHeader.style.visibility = 'visible';
    mainHeader.style.opacity = 1;
  }

  function loadIframeAfterAdjustment() {
    const flightSearchBar = document.querySelector('.flight-search-bar');
    if (!flightSearchBar) {
      console.error("Flight search bar not found.");
      return;
    }

    flightSearchBar.style.opacity = 1;
    flightSearchBar.setAttribute('src', 'https://staging-flights.devdksa.com/searchbar/');
  }

  // Ensure adjustments after everything is loaded
  function onWindowLoad() {
    adjustHeaderAndSearchBar();
    loadIframeAfterAdjustment();
  }

  // Ensure DOM readiness and late resources are covered
  document.addEventListener('DOMContentLoaded', () => {
    console.log("DOM fully loaded and parsed.");
    onWindowLoad();
    fallbackRecheck();
  });

  window.addEventListener('load', () => {
    console.log("Window fully loaded.");
    onWindowLoad();
    fallbackRecheck();
  });

  // Fallback for Safari rendering quirks
  function fallbackRecheck() {
    setTimeout(() => {
      adjustHeaderAndSearchBar();
    }, 100); // Allow layout stabilization
  }

  // Handle window resize
  window.addEventListener('resize', adjustHeaderAndSearchBar);



</script>

</html>